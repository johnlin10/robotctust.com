@use '@/app/styles/_mixins' as mixins;

$offsetPadding: 28px;

.floatingActions {
  z-index: 1000;
  position: fixed;
  @include mixins.flexbox(row, start, center);
  gap: var(--space-0-5x);
  padding: 6px;
  height: 52px;
  max-width: calc(100% - $offsetPadding * 2);
  background: rgba(var(--background-rgb), 0.5);
  border: 1px solid var(--border);
  @include mixins.border-radius(26px);
  @include mixins.glass-blur(12px);
  @include mixins.transition(var(--transition-default));
  @include mixins.hide-scrollbar;
  overflow: hidden;
  overflow-x: auto;

  &.initialRender {
    opacity: 0;
    @include mixins.transition(var(--transition-default));

    $scale: 0.5;
    &.bottom {
      &.right {
        @include mixins.transform-container(
          translateY(100%) translateX(calc(50% + $offsetPadding * 2))
            scale($scale)
        );
      }
      &.center {
        @include mixins.transform-container(
          translateY(100%) translateX(-50%) scale($scale)
        );
      }
      &.left {
        @include mixins.transform-container(
          translateY(100%) translateX(calc((50% - $offsetPadding * 2) * -1))
            scale($scale)
        );
      }
    }
    &.top {
      &.right {
        @include mixins.transform-container(
          translateY(-100%) translateX($offsetPadding * 2) scale($scale)
        );
      }
      &.center {
        @include mixins.transform-container(
          translateY(-100%) translateX(-50%) scale($scale)
        );
      }
      &.left {
        @include mixins.transform-container(
          translateY(-100%) translateX(calc((50% - $offsetPadding * 2) * -1))
            scale($scale)
        );
      }
    }
  }

  &.isCompactHeader:not(:hover) {
    gap: 0;
    padding: 3px;
    height: 32px !important;

    &.top {
      top: var(--header-height-compact);
    }

    &.bottom {
      &.center {
        @include mixins.respond-to('phone') {
          bottom: calc($offsetPadding / 2);
        }
      }
    }

    > .actionButton {
      padding: 0 var(--space-0-75x);

      &.noLabel {
        padding: 0 var(--space-0-75x) !important;
      }

      > svg {
        font-size: 0.8rem !important;
      }
      > .actionLabel {
        font-size: 0.7rem !important;
      }
    }
  }

  &.singleAction {
    padding: 0;
    height: 48px;

    &.isCompactHeader {
      padding: 0;

      > .actionButton {
        padding: 0 var(--space);
      }
    }
  }

  &.showBackground {
    background: rgba(var(--background-rgb), 0.5);
  }

  // Align
  &.right {
    right: $offsetPadding;
  }
  &.center {
    left: 50%;
    transform: translateX(-50%);
  }
  &.left {
    left: $offsetPadding;
  }

  // Position
  &.top {
    top: var(--header-height);

    &.right {
      right: var(--space-2x);
    }
    &.left {
      left: var(--space-2x);
    }
  }
  &.bottom {
    bottom: $offsetPadding;

    // &.right,
    // &.left {
    //   bottom: calc(var(--bottom-safe-area) + var(--space));
    // }
  }

  > .actionButton {
    @include mixins.flexbox(row, center, center);
    gap: var(--space-0-5x);
    height: 100%;
    padding: 0 var(--space);
    min-width: max-content;
    font-size: 1rem;
    border: 1px solid transparent;
    white-space: nowrap;
    text-decoration: none;
    color: inherit;
    @include mixins.border-radius(24px);
    @include mixins.transition(var(--transition-default));

    &:hover {
      border: 1px solid var(--border);
      background: rgba(var(--background-tertiary-rgb), 0.5);
    }

    &.noLabel {
      padding: 0 var(--space);
    }

    // 禁用狀態
    &:disabled,
    &.disabled {
      opacity: 0.5;
      cursor: not-allowed;
      pointer-events: none;
      @include mixins.transform-container(none);

      &:hover {
        border: 1px solid transparent;
        background: transparent;
        @include mixins.transform-container(none);
      }
    }

    // 變體樣式
    &.primary {
      background: var(--primary);
      color: var(--color-white);
    }

    &.danger {
      background: var(--danger);
      color: var(--text-on-danger);
    }

    // 自訂 action 樣式
    &.customAction {
      padding: 0;
      overflow: visible;
    }

    svg {
      font-size: 1.1rem;
      @include mixins.transition(var(--transition-default));
    }

    .actionLabel {
      font-size: 1rem;
      font-weight: 500;
      @include mixins.transition(var(--transition-default));
    }
  }
}

//* 模糊漸層效果
.gradient_blur {
  display: none;
  position: fixed;
  z-index: 900;
  inset: auto 0 0 0;
  height: calc(52px + 28px + 24px);
  width: 100%;
  pointer-events: none;
  @include mixins.transform-container(translateY(10%) rotate(180deg));

  &.compact {
    height: calc(32px + 28px + 24px);
  }

  &.bottom {
    display: block;
  }

  &::before {
    position: absolute;
    inset: 0;
    content: '';
    z-index: 1;
    backdrop-filter: blur(0.5px);
    filter: blur(0.5px);
    mask: linear-gradient(
      to top,
      rgba(0, 0, 0, 0) 0%,
      rgba(255, 255, 255, 1) 12.5%,
      rgba(255, 255, 255, 1) 25%,
      rgba(0, 0, 0, 0) 37.5%
    );
  }
  &::after {
    position: absolute;
    inset: 0;
    content: '';
    z-index: 8;
    backdrop-filter: blur(64px);
    filter: blur(64px);
    mask: linear-gradient(
      to top,
      rgba(0, 0, 0, 0) 87.5%,
      rgba(255, 255, 255, 1) 100%
    );
  }

  > div {
    position: absolute;
    inset: 0;

    &.gradient_background {
      z-index: 100;
      bottom: 0;
      height: 100%;
      background: linear-gradient(
        to bottom,
        rgba(var(--background-rgb), 1),
        #00000000
      );
    }
  }

  > div {
    &:nth-of-type(1) {
      z-index: 2;
      backdrop-filter: blur(1px);
      filter: blur(1px);
      mask: linear-gradient(
        to top,
        rgba(0, 0, 0, 0) 0%,
        rgba(255, 255, 255, 1) 25%,
        rgba(255, 255, 255, 1) 37.5%,
        rgba(0, 0, 0, 0) 50%
      );
    }
    &:nth-of-type(2) {
      z-index: 3;
      backdrop-filter: blur(2px);
      filter: blur(2px);
      mask: linear-gradient(
        to top,
        rgba(0, 0, 0, 0) 25%,
        rgba(255, 255, 255, 1) 37.5%,
        rgba(255, 255, 255, 1) 50%,
        rgba(0, 0, 0, 0) 62.5%
      );
    }
    &:nth-of-type(3) {
      z-index: 4;
      backdrop-filter: blur(4px);
      filter: blur(4px);
      mask: linear-gradient(
        to top,
        rgba(0, 0, 0, 0) 37.5%,
        rgba(255, 255, 255, 1) 50%,
        rgba(255, 255, 255, 1) 62.5%,
        rgba(0, 0, 0, 0) 75%
      );
    }
    &:nth-of-type(4) {
      z-index: 5;
      backdrop-filter: blur(8px);
      filter: blur(8px);
      mask: linear-gradient(
        to top,
        rgba(0, 0, 0, 0) 50%,
        rgba(255, 255, 255, 1) 62.5%,
        rgba(255, 255, 255, 1) 75%,
        rgba(0, 0, 0, 0) 87.5%
      );
    }
    &:nth-of-type(5) {
      z-index: 6;
      backdrop-filter: blur(16px);
      filter: blur(16px);
      mask: linear-gradient(
        to top,
        rgba(0, 0, 0, 0) 62.5%,
        rgba(255, 255, 255, 1) 75%,
        rgba(255, 255, 255, 1) 87.5%,
        rgba(0, 0, 0, 0) 100%
      );
    }
    &:nth-of-type(6) {
      z-index: 7;
      backdrop-filter: blur(64px);
      filter: blur(64px);
      // background: rgba(255, 255, 255, 1);
      mask: linear-gradient(
        to top,
        rgba(0, 0, 0, 0) 75%,
        rgba(255, 255, 255, 1) 87.5%,
        rgba(255, 255, 255, 1) 100%
      );
    }
  }
}
